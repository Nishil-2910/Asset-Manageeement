@model MobileReimbursement.Models.LoginModel
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta charset="utf-8">
    <TITLE>Mobile Reimbursement :: Cadila PharmaCeuticals Limited</TITLE>
    <meta name="description" content="User login page">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

    <link href="~/Content/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/jquery-ui.min.css" rel="stylesheet" type="text/css" />
    <!-- text fonts -->
    <link href="~/Content/text-fonts.css" rel="stylesheet" type="text/css" />
    <!-- ace styles -->
    <link href="~/Content/ace.min.css" rel="stylesheet" type="text/css" />

    <!--[if lte IE 9]>
            <link rel="stylesheet" href="~/Content/ace-part2.min.css" class="ace-main-stylesheet" />
        <![endif]-->
    <!--[if lte IE 9]>
      <link rel="stylesheet" href="~/Content/ace-ie.min.css" />
    <![endif]-->
    <!--[if lte IE 8]>
        <script src="~/Scripts/html5shiv.min.js"></script>
        <script src="~/Scripts/respond.min.js"></script>
    <![endif]-->

    <link href="~/Content/jquery.gritter.min.css" rel="stylesheet" type="text/css" />

    <!--[if !IE]> -->
    <script type="text/javascript" src="~/Scripts/jquery.min._NOTIEjs.js"></script>
    <!-- <![endif]-->
    <!--[if IE]>
        <script type="text/javascript" src="~/Scripts/jquery.min_IE.js"></script>
    <![endif]-->

    <script src="~/Scripts/bootstrap.min.js" type="text/javascript"></script>
    <script src="~/Scripts/jquery.validate.min.js" type="text/javascript"></script>
    <script src="~/Scripts/jquery-ui.min.js" type="text/javascript"></script>

    <!--[if lte IE 8]>
        <script src="~/Scripts/excanvas.min.js"></script>
    <![endif]-->

    <script src="~/Scripts/ace-elements.min.js" type="text/javascript"></script>
    <script src="~/Scripts/ace.min.js" type="text/javascript"></script>
    <script src="~/Scripts/jquery.form.js" type="text/javascript"></script>
    <script src="~/Scripts/json2.js" type="text/javascript"></script>
    <script src="~/Scripts/jquery.gritter.min.js" type="text/javascript"></script>
    <script src="~/Scripts/MyScripts.js" type="text/javascript"></script>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <SCRIPT language="JavaScript">
        $(document).ready(function () {
            $('#gritter-without-image').on(ace.click_event, function () {
                $.gritter.add({
                    // (string | mandatory) the heading of the notification
                    title: 'Error',
                    // (string | mandatory) the text inside the notification
                    text: 'This will fade out after a certain amount of time. Vivamus eget tincidunt velit. Cum sociis natoque penatibus et <a href="#" class="orange">magnis dis parturient</a> montes, nascetur ridiculus mus.',
                    class_name: 'gritter-error gritter-light'
                });


                return false;
            });

            var IsSessionOut = '@ViewBag.IsSessionOut';
            if (IsSessionOut != "") {
                ShowError(IsSessionOut);
            }

            var LoginError = '@Html.DisplayFor(m => m.LoginError)';
            var MessageCode = '@Html.DisplayFor(m => m.MessageCode)';

            if (MessageCode == "1") {
                ShowError(LoginError);
            }
        });
        function Canc() {
            document.frm_loginFrm.reset();
        }
        //function checks user details on login if found correct submits the request
        function loginCheck() {
            var frmid = "frm_loginFrm";
            var obj = validateForm();
            if (obj.form()) {
                var Form = document.getElementById(frmid);
                Form.action = "@Url.Action("Login", "Home")";
                Form.submit();
                return true;
            }
            else {
                var Form = document.getElementById(frmid);
                Form.action = "";
                return false;
            }
        }


        //this function is for submiting user information on enter on login page
        //function checkEnter(e) { //e is event object passed from function invocation
        //    var characterCode; //literal character code will be stored in this variable
        //    if (e && e.which) { //if which property of event object is supported (NN4)
        //        e = e;
        //        characterCode = e.which; //character code is contained in NN4's which property
        //    }
        //    else {
        //        e = event;
        //        characterCode = e.keyCode; //character code is contained in IE's keyCode property
        //    }
        //    if (characterCode == 13) { //if generated character code is equal to ascii 13 (if enter key)
        //        //document.forms[0].submit() //submit the form
        //        //return false
        //        loginCheck();
        //    }
        //    else {
        //        return true;
        //    }
        //}
    </SCRIPT>
</head>
<body class="login-layout light-login">


    <div class="main-container">
        <div class="main-content">
            <div class="row">
                <div class="col-sm-10 col-sm-offset-1">
                    <div class="login-container">
                        <div class="center">
                            <h1>
                                <i class="ace-icon">&nbsp;</i><span class="green">Mobile</span> <span class="grey"
                                                                                                     id="id-text2">Reimbursement</span>
                            </h1>
                            <h4 class="blue" id="id-company-text">
                                Cadila Pharmaceuticals Ltd.
                            </h4>
                        </div>
                        <div class="space-6">
                        </div>
                        <div class="position-relative">
                            <div id="login-box" class="login-box widget-box no-border visible">
                                @using (Html.BeginForm("Login", "Home", FormMethod.Post, new { name = "frm_loginFrm", id = "frm_loginFrm", novalidate = "novalidate" }))
                                {
                                    <div class="widget-body">
                                        <div class="widget-main">
                                            <br />
                                            <div class="social-or-login center">
                                                <span class="bigger-110">Login Details</span>
                                            </div>
                                            <br />
                                            <div class="space-6">
                                            </div>

                                            <div class="form-group">
                                                <label class="block clearfix">
                                                    <span class="block input-icon input-icon-right">
                                                        <input type="text" id="uid" name="uid" maxlength="7" class="form-control" placeholder="Employee ID">
                                                        <i class="ace-icon fa fa-user"></i>
                                                    </span>
                                                </label>
                                            </div>
                                            <div class="form-group">
                                                <label class="block clearfix">
                                                    <span class="block input-icon input-icon-right">
                                                        <input type="password" id="pwd" name="pwd" maxlength="45" class="form-control" placeholder="Password">
                                                        <i class="ace-icon fa fa-lock"></i>
                                                    </span>
                                                </label>
                                            </div>
                                            <div class="space">
                                            </div>
                                            <div class="clearfix">
                                                <span class="block input-icon input-icon-right">
                                                    <input type="submit" value="Login" class="width-35 pull-right btn btn-sm btn-primary" onclick="return loginCheck();" />
                                                    <i class="ace-icon fa fa-key white"></i>
                                                </span>
                                                @*<button type="button" id="loginbut" name="Submit" class="width-35 pull-right btn btn-sm btn-primary" onclick="return loginCheck();" >
                                                        <i class="ace-icon fa fa-key"></i><span class="bigger-110">Login</span>
                                                    </button>*@
                                            </div>
                                            <div class="space-4">
                                            </div>
                                        </div>
                                    </div>
                                }
                                <!-- /.widget-body -->
                                <div class="toolbar center">
                                    <a href="#" class="changepwd forgot-password-link" style="color:yellow">
                                        Change Password <i class="ace-icon fa fa-arrow-right">
                                        </i>
                                    </a>
                                </div>
                            </div>
                            <div id="changepwd-box" class="forgot-box widget-box no-border visible">
                                <div class="widget-body">
                                    <div class="widget-main">
                                        <h4 class="header red lighter bigger">
                                            <i class="ace-icon fa fa-key"></i>Change Password
                                        </h4>
                                        <div class="space-6">
                                        </div>
                                        @using (Html.BeginForm("ChangePassword", "Home", FormMethod.Post, new { name = "frm_changepwdFrm", id = "frm_changepwdFrm", novalidate = "novalidate" }))
                                        {

                                            <div class="form-group">
                                                <label class="block clearfix">
                                                    <span class="block input-icon input-icon-right">
                                                        <input type="text" id="c_uid" name="c_uid" maxlength="7" class="form-control" placeholder="Employee ID">
                                                        <i class="ace-icon fa fa-user"></i>
                                                    </span>
                                                </label>
                                            </div>
                                            <div class="form-group">
                                                <label class="block clearfix">
                                                    <span class="block input-icon input-icon-right">
                                                        <input type="password" id="c_pwd" name="c_pwd" maxlength="45" class="form-control"
                                                               placeholder="Old Password">
                                                        <i class="ace-icon fa fa-lock"></i>
                                                    </span>
                                                </label>
                                            </div>
                                            <div class="form-group">
                                                <label class="block clearfix">
                                                    <span class="block input-icon input-icon-right">
                                                        <input type="password" id="c_newpwd" name="c_newpwd" maxlength="45" class="form-control"
                                                               placeholder="New Password">
                                                        <i class="ace-icon fa fa-lock"></i>
                                                    </span>
                                                </label>
                                            </div>
                                            <div class="space">
                                            </div>
                                            <div class="clearfix">
                                                <span class="block input-icon input-icon-right">
                                                    <input type="submit" accesskey="s" value="Submit" class="width-35 pull-right btn btn-sm btn-primary"
                                                           onclick="return ChangePasswordCheck();" />
                                                    <i class="ace-icon fa fa-key white"></i>
                                                </span>
                                            </div>

                                        }
                                    </div>
                                    <!-- /.widget-main -->
                                    <div class="toolbar center">
                                        <a href="#" class="login back-to-login-link">
                                            Back to login <i class="ace-icon fa fa-arrow-left">
                                            </i>
                                        </a>
                                    </div>
                                </div>
                                <!-- /.widget-body -->
                            </div>

                        </div>
                        <div class="navbar-fixed-bottom align-center" style="margin-bottom: 30px;">
                            <br>
                            <p>Designed and Developed by Cadila PharmaCeuticals L i m i t e d.</p>
                        </div>
                    </div>
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
        </div>
        <!-- /.main-content -->
    </div>
    <div id="ajaxStatus" style="position: relative; z-index: 100;">
        <div id="dv_BellCurve" style="position:fixed; visibility: visible; top:0px; left:0px; width: 100%; height:100%; background-color: gray; overflow: hidden; filter:alpha(opacity=70); opacity:0.7;">

        </div>
        <div id="dv_BellCurveData" style="position: fixed; visibility:visible; top:0px; left:0px; width: 100%; height:100%; text-align:center; vertical-align:middle;">
            <div style="text-align:center; margin-top: 25%;">
                <img alt="" src="../Images/loading3.gif" />
            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $(document).ready(function () {
                $('#ajaxStatus').hide();
                $("#changepwd-box").hide();
                $("#login-box").show();
                $(document).ajaxStart(StartAjax);
                $(document).ajaxStop(EndAjax);

            });

            $(".changepwd").click(function () {
                $("#changepwd-box").show();
                $("#login-box").hide();
            });

            $(".login").click(function () {
                $("#changepwd-box").hide();
                $("#login-box").show();
            });

            function StartAjax() {
                $('#ajaxStatus').show();
            }
            function EndAjax() {
                $('#ajaxStatus').hide();
            }
        });

        function ChangePasswordCheck() {
            var frmid = "frm_changepwdFrm";
            var obj = validateChangePasswordForm(frmid);
            if (obj.form()) {
                var Form = document.getElementById(frmid);
                Form.action = "@Url.Action("ChangePassword", "Home")";
                Form.submit();
                return true;
            }
            else
            {
                var Form = document.getElementById(frmid);
                Form.action = "";
                return false;
            }
        }

        jQuery.validator.addMethod("notEqual", function (value, element, param) {
            return this.optional(element) || value != $(param).val();
        }, "");

        function validateChangePasswordForm(id) {
            return $("#" + id).validate({
                errorElement: 'div',
                errorClass: 'help-block',
                focusInvalid: false,
                ignore: "",
                rules: {
                    c_uid: {
                        required: true,
                        number: true
                    },
                    c_pwd: {
                        required: true
                    },
                    c_newpwd: {
                        required: true,
                        notEqual: "#c_pwd"
                    }
                },

                messages: {
                    uid: {
                        required: "Please enter employee id.",
                        number: 'Only Numeric Allowed'
                    },
                    c_pwd: {
                        required: "Please specify a Old Password."
                    },
                    c_newpwd: {
                        required: "Please specify a New Password.",
                        notEqual: "Old and New Password must be different."
                    }
                },


                highlight: function (e) {
                    $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
                },

                success: function (e) {
                    $(e).closest('.form-group').removeClass('has-error'); //.addClass('has-info');
                    $(e).remove();
                },

                errorPlacement: function (error, element) {
                    if (element.is('input[type=checkbox]') || element.is('input[type=radio]')) {
                        var controls = element.closest('div[class*="col-"]');
                        if (controls.find(':checkbox,:radio').length > 1) controls.append(error);
                        else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
                    }
                    else if (element.is('.select2')) {
                        error.insertAfter(element.siblings('[class*="select2-container"]:eq(0)'));
                    }
                    else if (element.is('.chosen-select')) {
                        error.insertAfter(element.siblings('[class*="chosen-container"]:eq(0)'));
                    }
                    else error.insertAfter(element.parent());
                },

                submitHandler: function (form) {
                },
                invalidHandler: function (form) {
                }
            });
        }

        function validateForm() {
            return $("#frm_loginFrm").validate({
                errorElement: 'div',
                errorClass: 'help-block',
                focusInvalid: false,
                ignore: "",
                rules: {
                    uid: {
                        required: true,
                        number: true,
                    },
                    pwd: {
                        required: true
                    }
                },

                messages: {
                    uid: {
                        required: "Please enter employee id.",
                        number: 'Only Numeric Allowed',
                    },
                    pwd: {
                        required: "Please specify a password."
                    }
                },


                highlight: function (e) {
                    $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
                },

                success: function (e) {
                    $(e).closest('.form-group').removeClass('has-error'); //.addClass('has-info');
                    $(e).remove();
                },

                errorPlacement: function (error, element) {
                    if (element.is('input[type=checkbox]') || element.is('input[type=radio]')) {
                        var controls = element.closest('div[class*="col-"]');
                        if (controls.find(':checkbox,:radio').length > 1) controls.append(error);
                        else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
                    }
                    else if (element.is('.select2')) {
                        error.insertAfter(element.siblings('[class*="select2-container"]:eq(0)'));
                    }
                    else if (element.is('.chosen-select')) {
                        error.insertAfter(element.siblings('[class*="chosen-container"]:eq(0)'));
                    }
                    else error.insertAfter(element.parent());
                },

                submitHandler: function (form) {
                },
                invalidHandler: function (form) {
                }
            });
        }

          var IsError = '@ViewBag.Error';
            if(IsError != "")
            {
                //jQuery.MyScript.ShowError(IsError);
                ShowError(IsError);
            }

             var IsSuccess = '@ViewBag.Success';
            if(IsSuccess != "")
            {
                //jQuery.MyScript.ShowSuccess(IsSuccess);
                ShowSuccess(IsSuccess);
            }
    </script>
</body>
</html>
